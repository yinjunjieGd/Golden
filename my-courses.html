<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æˆ‘çš„è¯¾ç¨‹ - æ™ºèƒ½å­¦ä¹ å¹³å°</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      color: #213547;
      min-height: 100vh;
      background: linear-gradient(135deg, #f0f4f8 0%, #e8eef5 100%);
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background-image: 
        radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(118, 75, 162, 0.08) 0%, transparent 50%),
        linear-gradient(rgba(148, 163, 184, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(148, 163, 184, 0.05) 1px, transparent 1px);
      background-size: 100% 100%, 100% 100%, 40px 40px, 40px 40px;
    }

    #app {
      width: 100%;
      min-height: 100vh;
    }

    /* å¯¼èˆªæ æ ·å¼ */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 5%;
      position: sticky;
      top: 0;
      z-index: 1000;
      background: linear-gradient(135deg, rgba(248, 250, 252, 0.95) 0%, rgba(241, 245, 249, 0.95) 100%);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(148, 163, 184, 0.15);
      box-shadow: 0 2px 12px rgba(100, 116, 139, 0.08);
    }

    .navbar::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%);
      box-shadow: 0 1px 4px rgba(59, 130, 246, 0.2);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
      transition: all 0.3s;
      position: relative;
    }

    .logo:hover {
      transform: translateY(-2px);
    }

    .logo-icon {
      font-size: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      filter: drop-shadow(0 2px 4px rgba(102, 126, 234, 0.3));
    }

    .logo-icon svg {
      width: 32px;
      height: 32px;
    }

    .logo-text {
      font-size: 1.375rem;
      font-weight: 700;
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .nav-links {
      display: flex;
      gap: 30px;
    }

    .nav-item {
      color: #64748b;
      text-decoration: none;
      font-size: 0.9375rem;
      font-weight: 500;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.625rem 1.25rem;
      border-radius: 0.5rem;
      position: relative;
    }

    .nav-item::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      border-radius: 0.5rem;
      opacity: 0;
      transition: opacity 0.3s;
      z-index: -1;
    }

    .nav-item:hover {
      color: #667eea;
      transform: translateY(-2px);
    }

    .nav-item:hover::before {
      opacity: 0.1;
    }

    .nav-item.active {
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      color: white;
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }

    .nav-icon {
      font-size: 1.125rem;
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
    }

    .nav-item.active::before {
      opacity: 0;
    }

    /* ä¸»å®¹å™¨ */
    .courses-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 40px 5%;
    }

    /* é¡µé¢æ ‡é¢˜ */
    .page-header {
      text-align: center;
      margin-bottom: 3rem;
      padding: 3rem;
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%);
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(59, 130, 246, 0.25), 0 4px 12px rgba(139, 92, 246, 0.15);
      position: relative;
      overflow: hidden;
    }

    .page-header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: rotate 20s linear infinite;
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .page-title {
      font-size: 2.5rem;
      font-weight: 800;
      color: white;
      margin-bottom: 1rem;
      line-height: 1.2;
      position: relative;
      z-index: 1;
    }

    .page-subtitle {
      font-size: 1.125rem;
      color: rgba(255, 255, 255, 0.9);
      line-height: 1.6;
      position: relative;
      z-index: 1;
    }

    /* åŠ è½½çŠ¶æ€ */
    .loading-container {
      text-align: center;
      padding: 60px 20px;
    }

    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(59, 130, 246, 0.2);
      border-top-color: #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      color: rgba(255, 255, 255, 0.7);
      font-size: 1.1rem;
    }

    /* é”™è¯¯æç¤º */
    .error-container {
      text-align: center;
      padding: 60px 20px;
    }

    .error-icon {
      font-size: 4rem;
      margin-bottom: 20px;
    }

    .error-message {
      color: #ef4444;
      font-size: 1.2rem;
      margin-bottom: 20px;
    }

    .retry-btn {
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      color: white;
      border: none;
      padding: 12px 32px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }

    .retry-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
      background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
    }

    /* è¯¾ç¨‹ç½‘æ ¼ */
    .courses-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }

    /* è¯¾ç¨‹å¡ç‰‡ */
    .course-card {
      background: white;
      border: 1px solid rgba(102, 126, 234, 0.15);
      border-radius: 12px;
      padding: 1.5rem;
      transition: all 0.3s;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.12), 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .course-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 0;
      background: linear-gradient(180deg, #667eea, #764ba2);
      transition: height 0.3s;
    }

    .course-card:hover {
      box-shadow: 0 12px 32px rgba(102, 126, 234, 0.2), 0 4px 12px rgba(0, 0, 0, 0.08);
      border-color: rgba(102, 126, 234, 0.4);
      transform: translateY(-4px);
    }

    .course-card:hover::before {
      height: 100%;
    }

    .course-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }

    .course-icon {
      width: 56px;
      height: 56px;
      background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 50%, #f472b6 100%);
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.75rem;
      flex-shrink: 0;
      box-shadow: 0 4px 12px rgba(96, 165, 250, 0.25);
      transition: all 0.3s;
    }

    .course-card:hover .course-icon {
      transform: scale(1.05) rotate(5deg);
      box-shadow: 0 6px 16px rgba(96, 165, 250, 0.35);
    }

    .course-info {
      flex: 1;
    }

    .course-title {
      font-size: 1.125rem;
      font-weight: 600;
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.75rem;
      line-height: 1.4;
    }

    .course-meta {
      display: flex;
      gap: 1rem;
      margin-bottom: 0.75rem;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      font-size: 0.875rem;
      color: #64748b;
    }

    .meta-icon {
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #3b82f6;
    }

    .course-description {
      color: #64748b;
      font-size: 0.95rem;
      margin-bottom: 1rem;
      line-height: 1.6;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .course-tags {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }

    .tag {
      background: rgba(59, 130, 246, 0.2);
      color: #60a5fa;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.85rem;
    }

    .course-footer {
      padding-top: 15px;
      border-top: 1px solid rgba(148, 163, 184, 0.2);
    }

    .course-progress {
      flex: 1;
    }

    .progress-label {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.6);
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
    }

    .progress-percent {
      color: #60a5fa;
      font-weight: 600;
    }

    .progress-bar {
      width: 100%;
      height: 0.5rem;
      background: #f1f5f9;
      border-radius: 9999px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%);
      border-radius: 9999px;
      transition: width 0.5s ease;
      box-shadow: 0 2px 6px rgba(59, 130, 246, 0.3);
    }

    .course-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .action-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.3s;
      white-space: nowrap;
      position: relative;
      z-index: 1;
    }

    .btn-icon {
      flex-shrink: 0;
    }

    .primary-btn {
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      color: white;
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }

    .primary-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
      background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
    }

    .secondary-btn {
      background: rgba(100, 116, 139, 0.1);
      color: #94a3b8;
      border: 1px solid rgba(148, 163, 184, 0.2);
    }

    .secondary-btn:hover {
      background: rgba(100, 116, 139, 0.15);
      color: #cbd5e1;
      border-color: rgba(148, 163, 184, 0.3);
      transform: translateY(-1px);
    }

    /* ç©ºçŠ¶æ€ */
    .empty-state {
      text-align: center;
      padding: 80px 20px;
    }

    .empty-icon {
      font-size: 5rem;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    .empty-message {
      color: rgba(255, 255, 255, 0.7);
      font-size: 1.2rem;
      margin-bottom: 30px;
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .courses-grid {
        grid-template-columns: 1fr;
      }

      .page-title {
        font-size: 2rem;
      }

      .nav-links {
        gap: 15px;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
      <div class="logo">
        <span class="logo-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
              </linearGradient>
            </defs>
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" stroke="url(#logoGradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" stroke="url(#logoGradient)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M9 6h7M9 10h7M9 14h5" stroke="url(#logoGradient)" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </span>
        <span class="logo-text">Pathfinder</span>
      </div>
      <div class="nav-links">
        <a href="my-courses.html" class="nav-item active">
          <span class="nav-icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
          æˆ‘çš„è¯¾ç¨‹
        </a>
      </div>
    </nav>

    <!-- ä¸»å†…å®¹ -->
    <div class="courses-container">
      <!-- é¡µé¢æ ‡é¢˜ -->
      <div class="page-header">
        <h1 class="page-title">æˆ‘çš„è¯¾ç¨‹</h1>
        <p class="page-subtitle">æ¢ç´¢çŸ¥è¯†çš„æ— é™å¯èƒ½</p>
      </div>

      <!-- åŠ è½½çŠ¶æ€ -->
      <div v-if="loading" class="loading-container">
        <div class="loading-spinner"></div>
        <p class="loading-text">åŠ è½½è¯¾ç¨‹ä¸­...</p>
      </div>

      <!-- é”™è¯¯çŠ¶æ€ -->
      <div v-else-if="error" class="error-container">
        <div class="error-icon">âš ï¸</div>
        <p class="error-message">{{ error }}</p>
        <button class="retry-btn" @click="loadCourses">é‡è¯•</button>
      </div>

      <!-- ç©ºçŠ¶æ€ -->
      <div v-else-if="courses.length === 0" class="empty-state">
        <div class="empty-icon">
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <p class="empty-message">æš‚æ— è¯¾ç¨‹æ•°æ®</p>
      </div>

      <!-- è¯¾ç¨‹åˆ—è¡¨ -->
      <div v-else class="courses-grid">
        <div 
          v-for="course in courses" 
          :key="course.id"
          class="course-card"
          @click="goToCourse(course.id)"
        >
          <div class="course-header">
            <div class="course-icon" v-html="getCourseIcon(course.name)"></div>
            <div class="course-info">
              <h3 class="course-title">{{ course.name }}</h3>
              <div class="course-meta">
                <span class="meta-item">
                  <svg class="meta-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <span>{{ course.lessonCount || 0 }}è¯¾æ—¶</span>
                </span>
                <span class="meta-item">
                  <svg class="meta-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                  <span>{{ course.duration || 'å¾…å®š' }}</span>
                </span>
              </div>
            </div>
          </div>

          <p class="course-description" v-if="course.description">
            {{ course.description }}
          </p>

          <div class="course-tags" v-if="course.tags && course.tags.length > 0">
            <span class="tag" v-for="tag in course.tags" :key="tag">{{ tag }}</span>
          </div>

          <div class="course-footer">
            <div class="course-progress">
              <div class="progress-label">
                <span>å­¦ä¹ è¿›åº¦</span>
                <span class="progress-percent">{{ course.progress || 0 }}%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" :style="{ width: (course.progress || 0) + '%' }"></div>
              </div>
            </div>
          </div>
          <div class="course-actions">
            <button class="action-btn secondary-btn" @click.stop="viewKnowledgeGraph(course.id)">
              <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="2" stroke="currentColor" stroke-width="2"/>
                <circle cx="12" cy="5" r="2" stroke="currentColor" stroke-width="2"/>
                <circle cx="12" cy="19" r="2" stroke="currentColor" stroke-width="2"/>
                <circle cx="5" cy="12" r="2" stroke="currentColor" stroke-width="2"/>
                <circle cx="19" cy="12" r="2" stroke="currentColor" stroke-width="2"/>
                <path d="M12 7v3m0 4v3m-5-5h3m4 0h3" stroke="currentColor" stroke-width="2"/>
              </svg>
              çŸ¥è¯†å›¾è°±
            </button>
            <button class="action-btn secondary-btn" @click.stop="viewStudyPlan(course.id)">
              <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                <path d="M3 10h18M8 3v4m8-4v4" stroke="currentColor" stroke-width="2"/>
              </svg>
              å­¦ä¹ è®¡åˆ’
            </button>
            <button class="action-btn primary-btn" @click.stop="startQuiz(course.id)">
              <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              å¼€å§‹ç­”é¢˜
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, onMounted } = Vue;

    createApp({
      setup() {
        // æ¥å£åœ°å€é…ç½® - ç¡¬ç¼–ç 
        const API_BASE_URL = 'http://localhost:8089';
        
        console.log('=== APIé…ç½®ä¿¡æ¯ ===');
        console.log('API_BASE_URL:', API_BASE_URL);
        console.log('==================');
        
        const courses = ref([]);
        const loading = ref(true);
        const error = ref(null);

        // SVGå›¾æ ‡é›†åˆ
        const svgIcons = {
          'Java': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 11V7a4 4 0 118 0v4M5 11h14l1 10H4l1-10z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'Python': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 20V10C8 7.79086 9.79086 6 12 6C14.2091 6 16 7.79086 16 10V20M8 20H16M8 20C6.89543 20 6 19.1046 6 18V10C6 5.58172 9.58172 2 14 2H18C19.1046 2 20 2.89543 20 4V16C20 17.1046 19.1046 18 18 18H16M16 20C17.1046 20 18 19.1046 18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',
          'JavaScript': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'C++': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13 10V3L4 14h7v7l9-11h-7z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'Go': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="4" y="4" width="16" height="16" rx="2" stroke="currentColor" stroke-width="2"/><path d="M9 9h6v6H9z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'Rust': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'Vue': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 3L12 20L19 3M7.5 3L12 13L16.5 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'React': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="2" stroke="currentColor" stroke-width="2"/><path d="M12 10c5 0 9-1.79 9-4s-4-4-9-4-9 1.79-9 4 4 4 9 4zm0 4c5 0 9 1.79 9 4s-4 4-9 4-9-1.79-9-4 4-4 9-4z" stroke="currentColor" stroke-width="2"/></svg>',
          'Angular': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L4 6v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V6l-8-4z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'Node': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/><path d="M12 7v10m5-5H7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',
          'Database': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="12" cy="5" rx="9" ry="3" stroke="currentColor" stroke-width="2"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" stroke="currentColor" stroke-width="2"/></svg>',
          'Algorithm': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/><rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/><rect x="14" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/><rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2"/></svg>',
          'Design': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 21a4 4 0 01-4-4V7a4 4 0 014-4h10a4 4 0 014 4v10a4 4 0 01-4 4H7zM7 3L17 13m0-10L7 13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',
          'AI': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'Machine Learning': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'Cloud': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'DevOps': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'Security': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="11" width="14" height="10" rx="2" stroke="currentColor" stroke-width="2"/><path d="M12 17v-2m-5-4V7a5 5 0 0110 0v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',
          'Mobile': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="2" width="14" height="20" rx="2" stroke="currentColor" stroke-width="2"/><path d="M12 18h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>',
          'Web': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/><path d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
          'default': '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'
        };

        // è·å–è¯¾ç¨‹å›¾æ ‡
        const getCourseIcon = (courseName) => {
          if (!courseName) return svgIcons.default;
          
          // éå†å›¾æ ‡æ˜ å°„ï¼ŒæŸ¥æ‰¾åŒ¹é…çš„å…³é”®è¯
          for (const [key, icon] of Object.entries(svgIcons)) {
            if (courseName.toLowerCase().includes(key.toLowerCase())) {
              return icon;
            }
          }
          
          // é»˜è®¤å›¾æ ‡
          return svgIcons.default;
        };

        // åŠ è½½è¯¾ç¨‹æ•°æ®
        const loadCourses = async () => {
          loading.value = true;
          error.value = null;

          try {
            const courseUrl = `${API_BASE_URL}/api/course/getDefaultCourses`;
            console.log('ğŸ“¡ [APIè°ƒç”¨] è·å–è¯¾ç¨‹åˆ—è¡¨');
            console.log('è¯·æ±‚URL:', courseUrl);
            
            // è°ƒç”¨è¯¾ç¨‹æŸ¥è¯¢æ¥å£
            const response = await fetch(courseUrl, {
              method: 'GET',
              headers: {
                'Accept': 'application/json; charset=utf-8'
              },
              credentials: 'include'
            });
            
            console.log('æ¥å£å“åº”çŠ¶æ€:', response.status);
            console.log('å“åº”å¤´Content-Type:', response.headers.get('content-type'));
            
            if (!response.ok) {
              const errorText = await response.text();
              console.error('æ¥å£è¿”å›é”™è¯¯å†…å®¹:', errorText);
              throw new Error(`HTTP é”™è¯¯! çŠ¶æ€ç : ${response.status}`);
            }

            const data = await response.json();
            console.log('æ¥å£è¿”å›çš„è¯¾ç¨‹æ•°æ®:', data);
            
            // åç«¯ç›´æ¥è¿”å›æ•°ç»„
            if (Array.isArray(data) && data.length > 0) {
              // ä¸ºæ¯ä¸ªè¯¾ç¨‹æ·»åŠ æ˜¾ç¤ºæ‰€éœ€çš„å­—æ®µ
              courses.value = data.map(course => ({
                id: course.id,
                name: course.title || course.name || 'æœªå‘½åè¯¾ç¨‹',
                lessonCount: course.lessonCount || Math.floor(Math.random() * 30) + 10,
                duration: course.duration || `${Math.floor(Math.random() * 40) + 10}å°æ—¶`,
                progress: course.progress || Math.floor(Math.random() * 100),
                tags: course.tags || ['åœ¨çº¿è¯¾ç¨‹'],
                description: course.description || 'æš‚æ— æè¿°'
              }));
            } else if (Array.isArray(data)) {
              // è¿”å›ç©ºæ•°ç»„
              courses.value = [];
            } else {
              throw new Error('æ¥å£è¿”å›çš„æ•°æ®æ ¼å¼ä¸æ­£ç¡®');
            }
          } catch (err) {
            console.error('åŠ è½½è¯¾ç¨‹å¤±è´¥:', err);
            error.value = err.message || 'åŠ è½½è¯¾ç¨‹æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
          } finally {
            loading.value = false;
          }
        };

        // è·³è½¬åˆ°è¯¾ç¨‹è¯¦æƒ…
        const goToCourse = (courseId) => {
          console.log('è·³è½¬åˆ°è¯¾ç¨‹:', courseId);
          // TODO: å®ç°è·³è½¬åˆ°è¯¾ç¨‹è¯¦æƒ…é¡µ
          // window.location.href = `course-detail.html?id=${courseId}`;
        };

        // æŸ¥çœ‹çŸ¥è¯†å›¾è°±
        const viewKnowledgeGraph = (courseId) => {
          console.log('æŸ¥çœ‹çŸ¥è¯†å›¾è°±:', courseId);
          // è°ƒç”¨å…¨å±€æ–¹æ³•æ˜¾ç¤ºçŸ¥è¯†å›¾è°±æ¨¡æ€æ¡†
          window.showKnowledgeGraph(courseId);
        };

        // æŸ¥çœ‹å­¦ä¹ è®¡åˆ’
        const viewStudyPlan = (courseId) => {
          console.log('æŸ¥çœ‹å­¦ä¹ è®¡åˆ’:', courseId);
          // è°ƒç”¨å…¨å±€æ–¹æ³•æ˜¾ç¤ºå­¦ä¹ è®¡åˆ’æ¨¡æ€æ¡†
          window.showStudyPlanModal(courseId);
        };

        // å¼€å§‹ç­”é¢˜
        const startQuiz = (courseId) => {
          console.log('å¼€å§‹ç­”é¢˜:', courseId);
          window.location.href = `quiz-app.html?courseId=${courseId}`;
        };

        // ç»„ä»¶æŒ‚è½½æ—¶åŠ è½½è¯¾ç¨‹
        onMounted(() => {
          loadCourses();
        });

        return {
          courses,
          loading,
          error,
          getCourseIcon,
          loadCourses,
          goToCourse,
          viewKnowledgeGraph,
          viewStudyPlan,
          startQuiz
        };
      }
    }).mount('#app');
  </script>
  
  <!-- çŸ¥è¯†å›¾è°±æ¨¡æ€æ¡† -->
  <div id="knowledgeGraphModal" class="modal-overlay" style="display: none;">
    <div class="modal-container">
      <div class="modal-header">
        <h3 class="modal-title">çŸ¥è¯†å›¾è°±</h3>
        <button id="closeModal" class="close-btn">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      <div class="modal-content">
        <div class="loading-indicator" style="display: none;">
          <div class="loading-spinner"></div>
          <p>åŠ è½½çŸ¥è¯†å›¾è°±ä¸­...</p>
        </div>
        <div id="graphImageContainer" class="graph-image-container">
          <img id="knowledgeGraphImage" src="" alt="çŸ¥è¯†å›¾è°±" style="display: none;">
        </div>
        <div id="errorContainer" class="error-message" style="display: none;"></div>
      </div>
    </div>
  </div>
  
  <!-- å­¦ä¹ è®¡åˆ’æ¨¡æ€æ¡† -->
  <div id="studyPlanModal" class="modal-overlay" style="display: none;">
    <div class="modal-container">
      <div class="modal-header">
        <h3 class="modal-title">å­¦ä¹ è®¡åˆ’</h3>
        <button id="closeStudyPlanModal" class="close-btn">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      <div class="modal-content">
        <div id="studyPlanLoading" class="loading-indicator" style="display: none;">
          <div class="loading-spinner"></div>
          <p id="loadingMessage">æ­£åœ¨å®šåˆ¶å­¦ä¹ è®¡åˆ’ï¼Œè¯·ç¨å...</p>
        </div>
        <div id="studyPlanOptions" class="study-plan-options" style="display: none;">
          <h4>é€‰æ‹©æ“ä½œ</h4>
          <p>è¯·é€‰æ‹©æ‚¨æƒ³è¦æ‰§è¡Œçš„æ“ä½œï¼š</p>
          <div class="options-buttons">
            <button id="generateNewPlanBtn" class="action-btn primary-btn">ç”Ÿæˆæ–°è®¡åˆ’</button>
            <button id="queryPlanBtn" class="action-btn secondary-btn">æŸ¥è¯¢è®¡åˆ’</button>
          </div>
        </div>
        <div id="studyPlanContent" class="study-plan-content" style="display: none;">
          <div class="plan-header">
            <h4 id="courseName"></h4>
            <div class="plan-summary">
              <span id="totalDuration"></span>
              <span id="totalPoints"></span>
            </div>
          </div>
          <div class="plan-items">
            <!-- å­¦ä¹ è®¡åˆ’é¡¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
          </div>
        </div>
        <div id="studyPlanError" class="error-message" style="display: none;"></div>
      </div>
    </div>
  </div>
  
  <style>
    /* çŸ¥è¯†å›¾è°±æ¨¡æ€æ¡†æ ·å¼ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      animation: fadeIn 0.3s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .modal-container {
      background: white;
      border-radius: 16px;
      width: 90%;
      max-width: 900px;
      max-height: 80vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 24px;
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 50%, #ec4899 100%);
      color: white;
    }
    
    .modal-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin: 0;
    }
    
    .close-btn {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      padding: 8px;
      border-radius: 8px;
      transition: background-color 0.3s;
    }
    
    .close-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .modal-content {
      flex: 1;
      padding: 24px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    
    .loading-indicator {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
      padding: 40px;
    }
    
    .loading-spinner {
      width: 48px;
      height: 48px;
      border: 4px solid rgba(59, 130, 246, 0.2);
      border-top-color: #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .graph-image-container {
      width: 100%;
      padding: 20px;
      background: rgba(59, 130, 246, 0.05);
      border-radius: 12px;
      border: 1px solid rgba(59, 130, 246, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 300px;
    }
    
    #knowledgeGraphImage {
      max-width: 100%;
      max-height: 50vh;
      border-radius: 8px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }
    
    .error-message {
      color: #ef4444;
      background: rgba(239, 68, 68, 0.1);
      padding: 16px 24px;
      border-radius: 8px;
      border: 1px solid rgba(239, 68, 68, 0.2);
      width: 100%;
      text-align: center;
    }
    
    /* å­¦ä¹ è®¡åˆ’æ ·å¼ */
    .study-plan-content {
      width: 100%;
      padding: 0;
    }
    
    .plan-header {
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.2);
    }
    
    .plan-header h4 {
      font-size: 1.25rem;
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 12px;
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .plan-summary {
      display: flex;
      gap: 24px;
    }
    
    .plan-summary span {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #64748b;
      font-size: 0.9rem;
    }
    
    .plan-items {
      display: flex;
      flex-direction: column;
      gap: 16px;
      max-height: 500px; /* è®¾ç½®æœ€å¤§é«˜åº¦ï¼Œç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½èƒ½æ˜¾ç¤º */
      overflow-y: auto; /* æ·»åŠ å‚ç›´æ»šåŠ¨æ¡ */
      padding-right: 8px; /* ä¸ºæ»šåŠ¨æ¡ç•™å‡ºç©ºé—´ */
    }
    
    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
    .plan-items::-webkit-scrollbar {
      width: 8px;
    }
    
    .plan-items::-webkit-scrollbar-track {
      background: rgba(148, 163, 184, 0.1);
      border-radius: 4px;
    }
    
    .plan-items::-webkit-scrollbar-thumb {
      background: rgba(148, 163, 184, 0.5);
      border-radius: 4px;
    }
    
    .plan-items::-webkit-scrollbar-thumb:hover {
      background: rgba(148, 163, 184, 0.8);
    }
    
    /* å­¦ä¹ è®¡åˆ’é€‰é¡¹æ ·å¼ */
    .study-plan-options {
      width: 100%;
      text-align: center;
      padding: 40px 20px;
    }
    
    .study-plan-options h4 {
      font-size: 1.25rem;
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 16px;
    }
    
    .study-plan-options p {
      color: #64748b;
      margin-bottom: 32px;
    }
    
    .options-buttons {
      display: flex;
      gap: 16px;
      justify-content: center;
    }
    
    /* æ— å­¦ä¹ è®¡åˆ’æç¤ºæ ·å¼ */
    .no-plan-message {
      text-align: center;
      padding: 40px 20px;
      color: #64748b;
    }
    
    .no-plan-message h4 {
      font-size: 1.1rem;
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 8px;
    }
    
    .plan-item {
      display: flex;
      gap: 16px;
      padding: 16px;
      background: rgba(248, 250, 252, 0.7);
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.1);
      transition: all 0.3s ease;
    }
    
    .plan-item:hover {
      background: rgba(248, 250, 252, 1);
      border-color: rgba(148, 163, 184, 0.3);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    
    .plan-order {
      flex-shrink: 0;
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 0.9rem;
      box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }
    
    .plan-item-content {
      flex: 1;
    }
    
    .plan-item-title {
      font-size: 1rem;
      font-weight: 600;
      color: #1e293b;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .plan-item-meta {
      display: flex;
      gap: 16px;
      margin-bottom: 8px;
    }
    
    .plan-item-meta span {
      display: flex;
      align-items: center;
      gap: 4px;
      color: #64748b;
      font-size: 0.85rem;
    }
    
    .ai-comment {
      font-size: 0.85rem;
      color: #475569;
      background: rgba(59, 130, 246, 0.05);
      padding: 12px;
      border-radius: 8px;
      border-left: 3px solid #3b82f6;
      margin-top: 8px;
    }
    
    .ai-comment-label {
      font-weight: 600;
      color: #3b82f6;
      margin-right: 6px;
    }
  </style>
  
  <script>
    // å­¦ä¹ è®¡åˆ’æ¨¡æ€æ¡†æ§åˆ¶
    document.addEventListener('DOMContentLoaded', () => {
      const studyPlanModal = document.getElementById('studyPlanModal');
      const closeStudyPlanModal = document.getElementById('closeStudyPlanModal');
      const studyPlanLoading = document.getElementById('studyPlanLoading');
      const studyPlanContent = document.getElementById('studyPlanContent');
      const studyPlanError = document.getElementById('studyPlanError');
      const studyPlanOptions = document.getElementById('studyPlanOptions');
      const planItemsContainer = document.querySelector('.plan-items');
      const courseNameElement = document.getElementById('courseName');
      const totalDurationElement = document.getElementById('totalDuration');
      const totalPointsElement = document.getElementById('totalPoints');
      
      // å…³é—­æ¨¡æ€æ¡†
      closeStudyPlanModal.addEventListener('click', () => {
        studyPlanModal.style.display = 'none';
      });
      
      // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
      studyPlanModal.addEventListener('click', (e) => {
        if (e.target === studyPlanModal) {
          studyPlanModal.style.display = 'none';
        }
      });
      
      // å…¨å±€æ–¹æ³•ï¼šæ˜¾ç¤ºå­¦ä¹ è®¡åˆ’
      window.showStudyPlanModal = (courseId, userId = 1) => {
        // é‡ç½®æ¨¡æ€æ¡†çŠ¶æ€
        studyPlanContent.style.display = 'none';
        studyPlanError.style.display = 'none';
        studyPlanLoading.style.display = 'none';
        studyPlanOptions.style.display = 'block';
        studyPlanModal.style.display = 'flex';
        planItemsContainer.innerHTML = '';
      };
      
      // ç”Ÿæˆæ–°è®¡åˆ’
      const generateNewPlan = async (courseId, userId = 1) => {
        // é‡ç½®æ¨¡æ€æ¡†çŠ¶æ€
        studyPlanContent.style.display = 'none';
        studyPlanError.style.display = 'none';
        studyPlanOptions.style.display = 'none';
        studyPlanLoading.style.display = 'flex';
        document.getElementById('loadingMessage').textContent = 'æ­£åœ¨å®šåˆ¶å­¦ä¹ è®¡åˆ’ï¼Œè¯·ç¨å...';
        planItemsContainer.innerHTML = '';
        
        try {
          // å°†å‚æ•°è½¬æ¢ä¸ºæ•´æ•°ç±»å‹
          const userIdInt = parseInt(userId, 10);
          const courseIdInt = parseInt(courseId, 10);
          
          const API_BASE_URL = 'https://pm-feel666service.gaodun.com';
          const apiUrl = `${API_BASE_URL}/api/study-plan/generate`;
          
          console.log('ğŸ“¡ [APIè°ƒç”¨] ç”Ÿæˆå­¦ä¹ è®¡åˆ’');
          console.log('è¯·æ±‚URL:', apiUrl);
          console.log('åŸå§‹å‚æ•°:', { userId, courseId });
          console.log('è½¬æ¢åå‚æ•°:', { userId: userIdInt, courseId: courseIdInt });
          console.log('å‚æ•°ç±»å‹:', { userIdType: typeof userIdInt, courseIdType: typeof courseIdInt });
          
          // åˆ›å»ºä¸€ä¸ªAbortControllerï¼Œè®¾ç½®è¾ƒé•¿çš„è¶…æ—¶æ—¶é—´ï¼ˆ10åˆ†é’Ÿï¼‰
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 10 * 60 * 1000); // 10åˆ†é’Ÿè¶…æ—¶
          
          // è°ƒç”¨å­¦ä¹ è®¡åˆ’æ¥å£ (POSTæ–¹æ³•)
          const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
              'Accept': 'application/json; charset=utf-8',
              'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify({ userId: userIdInt, courseId: courseIdInt }), // ä½¿ç”¨æ•´æ•°ç±»å‹
            signal: controller.signal
          });
          
          // æ¸…é™¤è¶…æ—¶å®šæ—¶å™¨
          clearTimeout(timeoutId);
          
          console.log('æ¥å£å“åº”çŠ¶æ€:', response.status);
          
          if (!response.ok) {
            throw new Error(`ç”Ÿæˆå­¦ä¹ è®¡åˆ’å¤±è´¥ï¼ŒçŠ¶æ€ç : ${response.status}`);
          }
          
          // è·å–æ¥å£è¿”å›çš„å­¦ä¹ è®¡åˆ’æ•°æ®
          const data = await response.json();
          
          // å¢åŠ è¯¦ç»†çš„æ¥å£è¿”å›ç»“æœè¾“å‡º
          console.log('æ¥å£è¿”å›çš„å­¦ä¹ è®¡åˆ’æ•°æ®:', data);
          console.log('ğŸ“Š æ•°æ®ç±»å‹:', typeof data);
          console.log('ğŸ“ æ˜¯å¦ä¸ºæ•°ç»„:', Array.isArray(data));
          
          // å¦‚æœæ˜¯æ•°ç»„ï¼Œè¾“å‡ºæ›´å¤šä¿¡æ¯
          if (Array.isArray(data)) {
            console.log('ğŸ“ˆ å­¦ä¹ è®¡åˆ’é¡¹æ•°é‡:', data.length);
            
            // å¦‚æœæœ‰æ•°æ®ï¼Œè¾“å‡ºç¬¬ä¸€æ¡æ•°æ®çš„ç»“æ„ä½œä¸ºç¤ºä¾‹
            if (data.length > 0) {
              console.log('ğŸ” ç¬¬ä¸€æ¡æ•°æ®ç»“æ„ç¤ºä¾‹:', Object.keys(data[0]));
              console.log('ğŸ“‹ ç¬¬ä¸€æ¡æ•°æ®è¯¦æƒ…:', JSON.stringify(data[0], null, 2));
            }
          } else if (typeof data === 'object' && data !== null) {
            // å¦‚æœæ˜¯å¯¹è±¡ï¼Œè¾“å‡ºå¯¹è±¡çš„é”®
            console.log('ğŸ”‘ å¯¹è±¡å±æ€§:', Object.keys(data));
            console.log('ğŸ“‹ å¯¹è±¡è¯¦æƒ…:', JSON.stringify(data, null, 2));
          }
          
          // è®°å½•å“åº”æ•°æ®çš„å¤§å°
          const dataSize = new Blob([JSON.stringify(data)]).size;
          console.log('ğŸ“ å“åº”æ•°æ®å¤§å°:', (dataSize / 1024).toFixed(2), 'KB');
          
          // å¤„ç†è¿”å›çš„æ•°æ®
          displayStudyPlanData(data);
        } catch (err) {
          console.error('ç”Ÿæˆå­¦ä¹ è®¡åˆ’å¤±è´¥:', err);
          if (err.name === 'AbortError') {
            studyPlanError.textContent = 'ç”Ÿæˆå­¦ä¹ è®¡åˆ’è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•';
          } else {
            studyPlanError.textContent = err.message || 'ç”Ÿæˆå­¦ä¹ è®¡åˆ’å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
          }
          studyPlanError.style.display = 'block';
        } finally {
          studyPlanLoading.style.display = 'none';
        }
      };
      
      // æŸ¥è¯¢è®¡åˆ’
      const queryStudyPlan = async (courseId, userId = 1) => {
        // é‡ç½®æ¨¡æ€æ¡†çŠ¶æ€
        studyPlanContent.style.display = 'none';
        studyPlanError.style.display = 'none';
        studyPlanOptions.style.display = 'none';
        studyPlanLoading.style.display = 'flex';
        document.getElementById('loadingMessage').textContent = 'æ­£åœ¨æŸ¥è¯¢å­¦ä¹ è®¡åˆ’ï¼Œè¯·ç¨å...';
        planItemsContainer.innerHTML = '';
        
        try {
          // å°†å‚æ•°è½¬æ¢ä¸ºæ•´æ•°ç±»å‹
          const userIdInt = parseInt(userId, 10);
          const courseIdInt = parseInt(courseId, 10);
          
          const API_BASE_URL = 'https://pm-feel666service.gaodun.com';
          const apiUrl = `${API_BASE_URL}/api/study-plan/query`;
          
          console.log('ğŸ“¡ [APIè°ƒç”¨] æŸ¥è¯¢å­¦ä¹ è®¡åˆ’');
          console.log('è¯·æ±‚URL:', apiUrl);
          console.log('åŸå§‹å‚æ•°:', { userId, courseId });
          console.log('è½¬æ¢åå‚æ•°:', { userId: userIdInt, courseId: courseIdInt });
          console.log('å‚æ•°ç±»å‹:', { userIdType: typeof userIdInt, courseIdType: typeof courseIdInt });
          console.log('å½“å‰window.currentCourseIdForStudyPlan:', window.currentCourseIdForStudyPlan);
          
          // åˆ›å»ºä¸€ä¸ªAbortControllerï¼Œè®¾ç½®è¾ƒé•¿çš„è¶…æ—¶æ—¶é—´ï¼ˆ10åˆ†é’Ÿï¼‰
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), 10 * 60 * 1000); // 10åˆ†é’Ÿè¶…æ—¶
          
          // å‡†å¤‡è¯·æ±‚é€‰é¡¹
          const requestOptions = {
            method: 'POST',
            headers: {
              'Accept': 'application/json; charset=utf-8',
              'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify({ userId: userIdInt, courseId: courseIdInt }), // ä½¿ç”¨æ•´æ•°ç±»å‹
            signal: controller.signal
          };
          
          console.log('è¯·æ±‚é€‰é¡¹:', requestOptions);
          
          // è°ƒç”¨å­¦ä¹ è®¡åˆ’æ¥å£ (POSTæ–¹æ³•)
          const response = await fetch(apiUrl, requestOptions);
          
          // æ¸…é™¤è¶…æ—¶å®šæ—¶å™¨
          clearTimeout(timeoutId);
          
          console.log('æ¥å£å“åº”çŠ¶æ€:', response.status);
          console.log('å“åº”å¤´:', Object.fromEntries(response.headers.entries()));
          
          if (!response.ok) {
            // å°è¯•è·å–è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
            try {
              const errorData = await response.text();
              console.error('æ¥å£è¿”å›çš„é”™è¯¯è¯¦æƒ…:', errorData);
              throw new Error(`æŸ¥è¯¢å­¦ä¹ è®¡åˆ’å¤±è´¥ï¼ŒçŠ¶æ€ç : ${response.status}, é”™è¯¯è¯¦æƒ…: ${errorData}`);
            } catch (innerErr) {
              throw new Error(`æŸ¥è¯¢å­¦ä¹ è®¡åˆ’å¤±è´¥ï¼ŒçŠ¶æ€ç : ${response.status}, æ— æ³•è§£æé”™è¯¯è¯¦æƒ…`);
            }
          }
          
          // è·å–æ¥å£è¿”å›çš„å­¦ä¹ è®¡åˆ’æ•°æ®
          const data = await response.json();
          console.log('æ¥å£è¿”å›çš„å­¦ä¹ è®¡åˆ’æ•°æ®:', data);
          
          // å¤„ç†è¿”å›çš„æ•°æ®
          if (!data || (Array.isArray(data) && data.length === 0)) {
            // æ²¡æœ‰å­¦ä¹ è®¡åˆ’æ•°æ®
            planItemsContainer.innerHTML = `
              <div class="no-plan-message">
                <h4>å½“å‰æ— å­¦ä¹ è®¡åˆ’</h4>
                <p>æ‚¨å¯ä»¥ç‚¹å‡»"ç”Ÿæˆæ–°è®¡åˆ’"æŒ‰é’®åˆ›å»ºä¸€ä¸ªå­¦ä¹ è®¡åˆ’ã€‚</p>
              </div>
            `;
            studyPlanContent.style.display = 'block';
          } else {
            displayStudyPlanData(data);
          }
        } catch (err) {
          console.error('æŸ¥è¯¢å­¦ä¹ è®¡åˆ’å¤±è´¥:', err);
          if (err.name === 'AbortError') {
            studyPlanError.textContent = 'æŸ¥è¯¢å­¦ä¹ è®¡åˆ’è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•';
          } else {
            studyPlanError.textContent = err.message || 'æŸ¥è¯¢å­¦ä¹ è®¡åˆ’å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
          }
          studyPlanError.style.display = 'block';
        } finally {
          studyPlanLoading.style.display = 'none';
        }
      };
      
      // æ˜¾ç¤ºå­¦ä¹ è®¡åˆ’æ•°æ®
      const displayStudyPlanData = (data) => {
        if (data && Array.isArray(data)) {
          // æŒ‰learningOrderæ’åº
          const sortedPlanItems = data.sort((a, b) => a.learningOrder - b.learningOrder);
          
          // è®¡ç®—æ€»å­¦ä¹ æ—¶é•¿
          const totalDuration = sortedPlanItems.reduce((sum, item) => sum + (item.studyDuration || 0), 0);
          
          // æ›´æ–°æ¨¡æ€æ¡†æ ‡é¢˜å’Œç»Ÿè®¡ä¿¡æ¯
          courseNameElement.textContent = `è¯¾ç¨‹å­¦ä¹ è®¡åˆ’`;
          totalDurationElement.textContent = `æ€»å­¦ä¹ æ—¶é•¿: ${totalDuration.toFixed(1)}å°æ—¶`;
          totalPointsElement.textContent = `çŸ¥è¯†ç‚¹æ•°é‡: ${sortedPlanItems.length}`;
          
          // ç”Ÿæˆå­¦ä¹ è®¡åˆ’é¡¹
          sortedPlanItems.forEach((item, index) => {
            const planItem = document.createElement('div');
            planItem.className = 'plan-item';
            
            // æ ¼å¼åŒ–å­¦ä¹ æ—¶é•¿
            const durationText = item.studyDuration ? `${item.studyDuration.toFixed(1)}å°æ—¶` : 'å¾…å®š';
            
            planItem.innerHTML = `
              <div class="plan-order">${index + 1}</div>
              <div class="plan-item-content">
                <div class="plan-item-title">
                  <span>${item.knowledgePointName || 'æœªå‘½åçŸ¥è¯†ç‚¹'}</span>
                  <span class="study-duration">${durationText}</span>
                </div>
                <div class="plan-item-meta">
                  <span>ä¼˜å…ˆçº§: ${item.learningOrder || (index + 1)}</span>
                </div>
                ${item.aiComment ? `
                  <div class="ai-comment">
                    <span class="ai-comment-label">AIå»ºè®®:</span>
                    ${item.aiComment}
                  </div>
                ` : ''}
              </div>
            `;
            
            planItemsContainer.appendChild(planItem);
          });
          
          // æ˜¾ç¤ºå­¦ä¹ è®¡åˆ’å†…å®¹
          studyPlanContent.style.display = 'block';
        } else {
          throw new Error('è¿”å›çš„æ•°æ®æ ¼å¼ä¸æ­£ç¡®ï¼Œå­¦ä¹ è®¡åˆ’ä¸ºç©º');
        }
      };
      
      // ç»‘å®šæŒ‰é’®äº‹ä»¶
      document.getElementById('generateNewPlanBtn').addEventListener('click', () => {
        // ä»å½“å‰è¯¾ç¨‹å¡ç‰‡è·å–courseId
        const courseId = window.currentCourseIdForStudyPlan || 1;
        generateNewPlan(courseId);
      });
      
      document.getElementById('queryPlanBtn').addEventListener('click', () => {
        // ä»å½“å‰è¯¾ç¨‹å¡ç‰‡è·å–courseId
        const courseId = window.currentCourseIdForStudyPlan || 1;
        queryStudyPlan(courseId);
      });
      
      // ä¿®æ”¹å…¨å±€æ–¹æ³•showStudyPlanModalï¼Œä¿å­˜å½“å‰courseId
      const originalShowStudyPlanModal = window.showStudyPlanModal;
      window.showStudyPlanModal = (courseId, userId = 1) => {
        // ä¿å­˜å½“å‰è¯¾ç¨‹ID
        window.currentCourseIdForStudyPlan = courseId;
        // è°ƒç”¨åŸå§‹æ–¹æ³•
        originalShowStudyPlanModal(courseId, userId);
      };
      
      console.log('å­¦ä¹ è®¡åˆ’æ¨¡æ€æ¡†åˆå§‹åŒ–å®Œæˆ');
    });
  </script>
  
  <script>
    // çŸ¥è¯†å›¾è°±æ¨¡æ€æ¡†æ§åˆ¶
    document.addEventListener('DOMContentLoaded', () => {
      const modal = document.getElementById('knowledgeGraphModal');
      const closeModal = document.getElementById('closeModal');
      const graphImage = document.getElementById('knowledgeGraphImage');
      const loadingIndicator = document.querySelector('.loading-indicator');
      const errorContainer = document.getElementById('errorContainer');
      const graphImageContainer = document.getElementById('graphImageContainer');
      
      // å…³é—­æ¨¡æ€æ¡†
      closeModal.addEventListener('click', () => {
        modal.style.display = 'none';
      });
      
      // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.style.display = 'none';
        }
      });
      
      // å…¨å±€æ–¹æ³•ï¼šæ˜¾ç¤ºçŸ¥è¯†å›¾è°±
      window.showKnowledgeGraph = async (courseId, userId = 1) => {
        // é‡ç½®æ¨¡æ€æ¡†çŠ¶æ€
        graphImage.style.display = 'none';
        errorContainer.style.display = 'none';
        loadingIndicator.style.display = 'flex';
        modal.style.display = 'flex';
        
        try {
          const API_BASE_URL = 'https://pm-feel666service.gaodun.com';
          const apiUrl = `${API_BASE_URL}/api/study-plan/knowledge-pic`;
          
          // ç¡®ä¿userIdæ˜¯æ•°å­—ç±»å‹
          const numericUserId = parseInt(userId, 10);
          
          console.log('ğŸ“¡ [APIè°ƒç”¨] è·å–çŸ¥è¯†å›¾è°±');
          console.log('è¯·æ±‚URL:', apiUrl);
          console.log('å‚æ•°:', { userId: numericUserId, courseId });
          
          // è°ƒç”¨çŸ¥è¯†å›¾è°±æ¥å£ (POSTæ–¹æ³•)
          const response = await fetch(apiUrl, {
            method: 'POST',
            headers: {
              'Accept': 'application/json; charset=utf-8',
              'Content-Type': 'application/json'
            },
            credentials: 'include',
            body: JSON.stringify({ userId: numericUserId, courseId })
          });
          
          console.log('æ¥å£å“åº”çŠ¶æ€:', response.status);
          
          if (!response.ok) {
            throw new Error(`è·å–çŸ¥è¯†å›¾è°±å¤±è´¥ï¼ŒçŠ¶æ€ç : ${response.status}`);
          }
          
          // æ¥å£è¿”å›çš„æ˜¯Stringç±»å‹çš„å›¾ç‰‡base64ç¼–ç 
          const imageBase64 = await response.text();
          console.log('æ¥å£è¿”å›çš„æ•°æ®ç±»å‹:', typeof imageBase64);
          console.log('æ¥å£è¿”å›çš„æ•°æ®é•¿åº¦:', imageBase64.length);
          
          // æ£€æŸ¥è¿”å›æ•°æ®æ˜¯å¦æœ‰æ•ˆ
          if (imageBase64 && typeof imageBase64 === 'string' && imageBase64.length > 0) {
            // åˆ›å»ºå›¾ç‰‡URLå¹¶æ˜¾ç¤º
            // ç¡®ä¿base64ç¼–ç æ²¡æœ‰å‰ç¼€ï¼Œå¦‚æœæœ‰åˆ™ç§»é™¤
            let cleanBase64 = imageBase64;
            if (cleanBase64.startsWith('data:image')) {
              cleanBase64 = cleanBase64.substring(cleanBase64.indexOf(',') + 1);
            }
            graphImage.src = `data:image/png;base64,${cleanBase64}`;
            graphImage.style.display = 'block';
          } else {
            throw new Error('è¿”å›çš„æ•°æ®æ— æ•ˆï¼Œä¸æ˜¯æœ‰æ•ˆçš„å›¾ç‰‡base64ç¼–ç ');
          }
        } catch (err) {
          console.error('åŠ è½½çŸ¥è¯†å›¾è°±å¤±è´¥:', err);
          errorContainer.textContent = err.message || 'åŠ è½½çŸ¥è¯†å›¾è°±å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
          errorContainer.style.display = 'block';
          
          // ä¸ºäº†æ¼”ç¤ºï¼Œä½¿ç”¨ä¸€ä¸ªå ä½å›¾ç‰‡
          graphImage.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTUwLDAgTDQwMCwwIEw0MDAsMzAwIEw1MCwzMDAgeiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMzBkNGY3IiBzdHJva2Utd2lkdGg9IjIiLz4KPGNpcmNsZSBjeD0iMjAwIiBjeT0iMTUwIiByPSI4MCIgZmlsbD0iI2ZhZmJmZiIgZmlsbC1vcGFjaXR5PSIwLjQiIHN0cm9rZT0iIzM2YjVkOSIgc3Ryb2tlLXdpZHRoPSIyIi8+CjxyZWN0IHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgZmlsbD0iIzM2YjVkOSIgZmlsbC1vcGFjaXR5PSIwLjgiIHg9IjIwMCIgeT0iMTUwIi8+CjxwYXRoIGQ9Ik0xOTAsMTUwIEwxOTAsNjAgTDE5NSw2MCBMMTk1LDE1MCBaIiBmaWxsPSIjNDlhNGYwIiBmaWxsLW9wYWNpdHk9IjAuOCIgZmlsbC1ydWxlPSJldmVub2RkIi8+CjxwYXRoIGQ9Ik0yMDAsMTUwIEwyMDAsNjAgTDIwNSw2MCBMMjA1LDE1MCBaIiBmaWxsPSIjNDlhNGYwIiBmaWxsLW9wYWNpdHk9IjAuOCIgZmlsbC1ydWxlPSJldmVub2RkIi8+CjxwYXRoIGQ9Ik0yMTAsMTUwIEwyMTAsNjAgTDIxNSw2MCBMMjE1LDE1MCBaIiBmaWxsPSIjNDlhNGYwIiBmaWxsLW9wYWNpdHk9IjAuOCIgZmlsbC1ydWxlPSJldmVub2RkIi8+CjxwYXRoIGQ9Ik0yMjAsMTUwIEwyMjAsNjAgTDIyNSw2MCBMMjI1LDE1MCBaIiBmaWxsPSIjNDlhNGYwIiBmaWxsLW9wYWNpdHk9IjAuOCIgZmlsbC1ydWxlPSJldmVub2RkIi8+CjxwYXRoIGQ9Ik0yMzAsMTUwIEwyMzAsNjAgTDIzNSw2MCBMMjM1LDE1MCBaIiBmaWxsPSIjNDlhNGYwIiBmaWxsLW9wYWNpdHk9IjAuOCIgZmlsbC1ydWxlPSJldmVub2RkIi8+CjxwYXRoIGQ9Ik0xNTAsMTUwIEwxNTAsMTAwIEwxNTUsMTAwIEwxNTUsMTUwIFoiIGZpbGw9IiM0OWE0ZjAiIGZpbGwtb3BhY2l0eT0iMC44IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz4KPHBhdGggZD0iTTE2MCwxNTAgTTE2MCwxMDAgTTE2NSwxMDAgTTE2NSwxNTAgWiIgZmlsbD0iIzQ5YTRmMCIgZmlsbC1vcGFjaXR5PSIwLjgiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPgo8cGF0aCBkPSJNMTcwLDE1MCBMMTcwLDEwMCBMMTc1LDEwMCBMMTc1LDE1MCBaIiBmaWxsPSIjNDlhNGYwIiBmaWxsLW9wYWNpdHk9IjAuOCIgZmlsbC1ydWxlPSJldmVub2RkIi8+CjxwYXRoIGQ9Ik0xODAsMTUwIEwxODAsMTAwIEwxODUsMTAwIEwxODUsMTUwIFoiIGZpbGw9IiM0OWE0ZjAiIGZpbGwtb3BhY2l0eT0iMC44IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz4KPHJlY3QgeD0iMTQwIiB5PSIxMCIgd2lkdGg9IjEyMCIgaGVpZ2h0PSIxMCIgZmlsbD0iIzM2YjVkOSIgZmlsbC1vcGFjaXR5PSIwLjgiLz4KPGNpcmNsZSBjeD0iMTEwIiBjeT0iMjAwIiByPSIxMCIgZmlsbD0iIzM2YjVkOSIgZmlsbC1vcGFjaXR5PSIwLjgiLz4KPGNpcmNsZSBjeD0iMjkwIiBjeT0iMjAwIiByPSIxMCIgZmlsbD0iIzM2YjVkOSIgZmlsbC1vcGFjaXR5PSIwLjgiLz4KPHBhdGggZD0iTTEzMCwyMDAgTDI3MCwyMDAiIHN0cm9rZT0iIzM2YjVkOSIgc3Ryb2tlLW9wYWNpdHk9IjAuOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtcmFkaWFsPSJ1cmwoI3BhdGgpIi8+CjxwYXRoIGQ9Ik0xMTAsMjIwIEwxMTAsMTgwIEwyOTAsMTgwIEwyOTAsMjIwIFoiIHN0cm9rZT0iIzM2YjVkOSIgc3Ryb2tlLW9wYWNpdHk9IjAuOCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+CjxwYXRoIGQ9Ik0xMDAsMTAwIEw4MCwxMjAgTDYwLDEwMCBMNjAsODAgTDgwLDYwIEwxMDAsODAgTDEyMCw2MCBMMTQwLDgwIEwxMjAsMTAwIFoiIHN0cm9rZT0iIzY4YjBhYyIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtcmFkaWFsPSJ1cmwoI3BhdGg3KSIgZmlsbD0ibm9uZSIgc3Ryb2tlLW9wYWNpdHk9IjAuOCIvPgo8L3N2Zz4=';
            graphImage.style.display = 'block';
        } finally {
          loadingIndicator.style.display = 'none';
        }
      };
      
      // ä¸ºäº†æ¼”ç¤ºï¼Œåœ¨é¡µé¢åŠ è½½åæ‰§è¡Œä¸€äº›åˆå§‹åŒ–
      console.log('çŸ¥è¯†å›¾è°±æ¨¡æ€æ¡†åˆå§‹åŒ–å®Œæˆ');
    });
  </script>
</body>
</html>